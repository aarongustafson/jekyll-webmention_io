{% capture current_url %}{{ page.url | replace:".html","" }}{% endcapture %}
<nav data-current="{{ current_url }}">
  <h2>More About This Gem</h2>
  <ol>
    {% for link in site.data.nav %}
      <li>
        {% capture title %}
          {% if link.title %}
            {{ link.title }}
          {% else %}
            {{ link.slug | replace:"-", " " | capitalize }}
          {% endif %}
        {% endcapture %}
        {% capture the_link %}/{{ link.slug }}{% endcapture %}
        <a href="{{ the_link }}"{% if the_link == current_url %} aria-current="page"{% endif %}>{{ title | trim }}</a>
        {% if link.subnav %}
          <ol>
            {% for sublink in link.subnav %}
              <li>
                {% capture sublink_title %}
                  {% if sublink.title %}
                    {{ sublink.title }}
                  {% else %}
                    {{ sublink.slug | replace:"-", " " | capitalize }}
                  {% endif %}
                {% endcapture %}
                {% capture the_link %}/{{ link.slug }}/{{ sublink.slug }}{% endcapture %}
                <a href="{{ the_link }}"{% if the_link == current_url %} aria-current="page"{% endif %}>{{ sublink_title | trim }}</a>
              </li>
            {% endfor %}
          </ol>
        {% endif %}
      </li>
    {% endfor %}
  </ol>
</nav>